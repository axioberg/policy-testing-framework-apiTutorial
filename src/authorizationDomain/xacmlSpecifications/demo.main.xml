<?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main" Version="1.0" xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main.order" Version="1.0"><xacml3:Description>Policies for the account api</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:3.0:function:string-starts-with"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">/order</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="api.path" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main.order.view" Version="1.0"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">GET</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="api.method" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main.order.view.customer" Version="1.0"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Customer</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:on-permit-apply-second" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main.order.view.customer.memberOfAccount" Version="1.0"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/demo.main.order.view.customer.memberOfAccount.conditionpolicy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides" Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target/><xacml3:Rule Effect="Permit" RuleId="http://axiomatics.com/alfa/identifier/demo.main.order.view.customer.memberOfAccount.conditionrule"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="account.member" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.uid" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/demo.main.order.view.customer.memberOfAccount.actualPolicy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target/><xacml3:Rule Effect="Permit" RuleId="demo.main.order.view.customer.memberOfAccount/demo.library.permitAccountOwner"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="account.owner" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.uid" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="advice.message" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression AttributeId="message.permitReason" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">User is the account owner</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule><xacml3:Rule Effect="Permit" RuleId="demo.main.order.view.customer.memberOfAccount/demo.library.minorsCanOnlyGetReceiptsForTheirOrders"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="order.uid" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.uid" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than"/><xacml3:AttributeDesignator AttributeId="user.age" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="false"/><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">18</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="account.class" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Family</xacml3:AttributeValue></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Condition><xacml3:ObligationExpressions><xacml3:ObligationExpression FulfillOn="Permit" ObligationId="recieptFields"><xacml3:AttributeAssignmentExpression AttributeId="allowed" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">field1</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression><xacml3:AttributeAssignmentExpression AttributeId="allowed" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">field2</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:ObligationExpression><xacml3:ObligationExpression FulfillOn="Permit" ObligationId="axiomatics.demo.fields"><xacml3:AttributeAssignmentExpression AttributeId="axiomatics.demo.mask_fields" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">accountBalance</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:ObligationExpression></xacml3:ObligationExpressions><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="advice.message" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression AttributeId="message.permitReason" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Minors can view their receipts</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy></xacml3:PolicySet><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="advice.pathValidation" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression AttributeId="message.policyPath" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Customers viewing receipts</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression><xacml3:AdviceExpression AdviceId="advice.pathValidation" AppliesTo="Deny"><xacml3:AttributeAssignmentExpression AttributeId="message.policyPath" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Customers viewing receipts</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:PolicySet><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/demo.main.order.view.customerService" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit" Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Customer Service</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="demo.main.order.view.customerService.permitIfInSameCountryAsOrder"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="order.country" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.country" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="advice.message" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression AttributeId="message.permitReason" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Customer Service reps can access receipts of order in their country</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy></xacml3:PolicySet><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main.order.promotionalOffers" Version="1.0"><xacml3:Description>Policies for the promotional order api</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">/order/promotion</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="api.path" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:PolicyIdReference>http://axiomatics.com/alfa/identifier/demo.library.universalDenyRules</xacml3:PolicyIdReference><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/demo.main.order.promotionalOffers.placeOrder" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit" Version="1.0"><xacml3:Description>Place an order</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">POST</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="api.method" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="demo.main.order.promotionalOffers.placeOrder/demo.library.allowIfUserInCountryOfPromotion"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="promotion.country" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.country" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="advice.message" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression AttributeId="message.permitReason" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">User in same country as promotion</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy></xacml3:PolicySet></xacml3:PolicySet><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit" PolicySetId="http://axiomatics.com/alfa/identifier/demo.main.account" Version="1.0"><xacml3:Description>Policies for the account api</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:3.0:function:string-starts-with"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">/accunt</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="api.path" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/demo.main.account.updateAccount" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit" Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">UPDATE</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="api.method" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="demo.main.account.updateAccount/demo.library.permitAccountOwner"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="account.owner" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.uid" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="advice.message" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression AttributeId="message.permitReason" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">User is the account owner</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy></xacml3:PolicySet></xacml3:PolicySet>